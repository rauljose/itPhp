<!DOCTYPE html>
<html lang="es-MX es">
<head>
    <meta charset="UTF-8">
    <title>jqGridFilterBuilder Test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>

    <link rel="stylesheet" href="../../../../tools/qUnit/qunit.min.css">
    <script src="../jqGridFilterBuilder.js"></script>
</head>
<body>

    <div id="qunit"></div>
    <div id="qunit-fixture"></div>
    <i>Chrome code coverage: developer tools -&gt; hambuger menu -&gt; More Tools -&gt; Coverage</i>

    <script src="../../../../tools/qUnit/qunit.min.js"></script>
    <script>
        var f = jqGridFilterBuilder;
        QUnit.module('jqGridFilterBuilder', function() {
            QUnit.test('Rules', function(assert) {
                assert.deepEqual(f.OR(['col1', 'cn', 1]), f.OR({field:'col1', op:'cn', data:1}), "array = {field:'a',op:'eq',data:1");
                assert.deepEqual(f.OR(), {"groupOp": "OR", "groups": [], "rules": []} ,"empty or");
                assert.deepEqual(f.AND(), {"groupOp": "AND", "groups": [], "rules": []} ,"empty and");
                assert.deepEqual(f.XOR(), {"groupOp": "XOR", "groups": [], "rules": []} ,"empty xor");
                assert.deepEqual(f.NOT(), {"groupOp": "NOT", "groups": [], "rules": []} ,"empty not");
            });

            QUnit.test('GroupBy', function(assert) {
                assert.deepEqual(
                    f.OR(['col1', 'eq', 1],['colA', 'ne', 'B'])  ,
                    {
                        "groupOp": "OR",
                        "rules": [
                            {
                                "field": "col1",
                                "op": "eq",
                                "data": 1
                            },
                            {
                                "field": "colA",
                                "op": "ne",
                                "data": "B"
                            }
                        ],
                        "groups": []
                }, "simple or");
                assert.deepEqual(
                    f.AND(['col1', 'eq', 1],['colA', 'ne', 'B'])  ,
                    {
                        "groupOp": "AND",
                        "rules": [
                            {
                                "field": "col1",
                                "op": "eq",
                                "data": 1
                            },
                            {
                                "field": "colA",
                                "op": "ne",
                                "data": "B"
                            }
                        ],
                        "groups": []
                }, "simple and");
                assert.deepEqual(
                    f.XOR(['col1', 'eq', 1],['colA', 'ne', 'B'])  ,
                    {
                        "groupOp": "XOR",
                        "rules": [
                            {
                                "field": "col1",
                                "op": "eq",
                                "data": 1
                            },
                            {
                                "field": "colA",
                                "op": "ne",
                                "data": "B"
                            }
                        ],
                        "groups": []
                    }
                    ,"simple xor"
                )

            });




        QUnit.test('groups', function(assert) {
            assert.deepEqual(
                f.OR(
                    ['col', 'eq', 1], ['col1', 'in', ['Si', 'No se']],
                    f.NOT( f.XOR(['col2', 'ge', 2], ['col3', 'gt', 3]) ),
                    f.AND(['col4', 'lt', 20], ['col5', 'le', 30])
                ),
                {
                    "groupOp": "OR",
                    "rules": [
                        {
                            "field": "col",
                            "op": "eq",
                            "data": 1
                        },
                        {
                            "field": "col1",
                            "op": "in",
                            "data": [
                                "Si",
                                "No se"
                            ]
                        }
                    ],
                    "groups": [
                        {
                            "groupOp": "NOT",
                            "rules": [],
                            "groups": [
                                {
                                    "groupOp": "XOR",
                                    "rules": [
                                        {
                                            "field": "col2",
                                            "op": "ge",
                                            "data": 2
                                        },
                                        {
                                            "field": "col3",
                                            "op": "gt",
                                            "data": 3
                                        }
                                    ],
                                    "groups": []
                                }
                            ]
                        },
                        {
                            "groupOp": "AND",
                            "rules": [
                                {
                                    "field": "col4",
                                    "op": "lt",
                                    "data": 20
                                },
                                {
                                    "field": "col5",
                                    "op": "le",
                                    "data": 30
                                }
                            ],
                            "groups": []
                        }
                    ]
                }
            );

            assert.deepEqual(
                f.OR(
                    ['col', 'eq', 1], ['col1', 'in', ['Si', 'No se']],
                    f.NOT( f.XOR(['col2', 'ge', 2], ['col3', 'gt', 3]) ),
                    f.AND(['col4', 'lt', 20], ['col5', 'le', 30])
                ),
                {
                    "groupOp": "OR",
                    "rules": [
                        {
                            "field": "col",
                            "op": "eq",
                            "data": 1
                        },
                        {
                            "field": "col1",
                            "op": "in",
                            "data": [
                                "Si",
                                "No se"
                            ]
                        }
                    ],
                    "groups": [
                        {
                            "groupOp": "NOT",
                            "rules": [],
                            "groups": [
                                {
                                    "groupOp": "XOR",
                                    "rules": [
                                        {
                                            "field": "col2",
                                            "op": "ge",
                                            "data": 2
                                        },
                                        {
                                            "field": "col3",
                                            "op": "gt",
                                            "data": 3
                                        }
                                    ],
                                    "groups": []
                                }
                            ]
                        },
                        {
                            "groupOp": "AND",
                            "rules": [
                                {
                                    "field": "col4",
                                    "op": "lt",
                                    "data": 20
                                },
                                {
                                    "field": "col5",
                                    "op": "le",
                                    "data": 30
                                }
                            ],
                            "groups": []
                        }
                    ]
                }

            )
        });

        QUnit.test('join filters', function(assert) {

            assert.deepEqual(
                f.filterOrFilter(
                    f.AND(['colAnd1','eq',1],['colAnd2','eq',2]),
                    f.AND(['colAnd3','eq',3],['colAnd4','eq',4]),
                ),
                {
                    "groupOp": "OR",
                    "rules": [],
                    "groups": [
                        {
                            "groupOp": "AND",
                            "rules": [
                                {
                                    "field": "colAnd1",
                                    "op": "eq",
                                    "data": 1
                                },
                                {
                                    "field": "colAnd2",
                                    "op": "eq",
                                    "data": 2
                                }
                            ],
                            "groups": []
                        },
                        {
                            "groupOp": "AND",
                            "rules": [
                                {
                                    "field": "colAnd3",
                                    "op": "eq",
                                    "data": 3
                                },
                                {
                                    "field": "colAnd4",
                                    "op": "eq",
                                    "data": 4
                                }
                            ],
                            "groups": []
                        }
                    ]
                }
                , "join 2 filters with OR"
            );

            assert.deepEqual(
                f.filterAndFilter(
                    f.OR(['colOr1','eq',1],['colOr2','eq',2]),
                    f.OR(['colOr3','eq',3],['colOr4','eq',4]),
                ),
                {
                    "groupOp": "AND",
                    "rules": [],
                    "groups": [
                        {
                            "groupOp": "OR",
                            "rules": [
                                {
                                    "field": "colOr1",
                                    "op": "eq",
                                    "data": 1
                                },
                                {
                                    "field": "colOr2",
                                    "op": "eq",
                                    "data": 2
                                }
                            ],
                            "groups": []
                        },
                        {
                            "groupOp": "OR",
                            "rules": [
                                {
                                    "field": "colOr3",
                                    "data": 3,
                                    "op": "eq",
                                },
                                {
                                    "field": "colOr4",
                                    "op": "eq",
                                    "data": 4
                                },
                            ],
                            "groups": []
                        }
                    ]
                }
                , "join 2 filters with AND"
            );
        });

        });
    </script>
</body>
</html>

                                                                                                                                                                                                                </html>